@page
@model BD.RazorPages.Pages.Public.BloodCompatibilityPages.SearchModel
@{
    ViewData["Title"] = "Blood Compatibility Search";
}

<h2>Search Compatible Blood Types</h2>

<form method="post" class="mt-3">
    <div class="form-group">
        <label>Search Mode</label>
        <select asp-for="SearchMode" class="form-control">
            <option value="WholeBlood">Whole Blood</option>
            <option value="Component">By Blood Component</option>
        </select>
    </div>

    <div class="form-group mt-2">
        <label>Recipient Blood Type</label>
        <select asp-for="RecipientBloodType" class="form-control">
            <option value="">-- Select --</option>
            <option value="A+">A+</option>
            <option value="A-">A-</option>
            <option value="B+">B+</option>
            <option value="B-">B-</option>
            <option value="AB+">AB+</option>
            <option value="AB-">AB-</option>
            <option value="O+">O+</option>
            <option value="O-">O-</option>
        </select>
    </div>

    @if (Model.SearchMode == "Component")
    {
        <div class="form-group mt-2">
            <label>Component Type</label>
            <select asp-for="ComponentType" class="form-control">
                <option>Red Blood Cells</option>
                <option>Plasma</option>
                <option>Platelets</option>
                <option>White Blood Cells</option>
            </select>
        </div>
    }

    <button type="submit" class="btn btn-primary mt-3">Search</button>
</form>

@if (Model.DonorMatches?.Count > 0)
{
    <h4 class="mt-4">Compatible Donor Blood Types:</h4>
    <ul>
        @foreach (var type in Model.DonorMatches)
        {
            <li class="list-group-item">@type</li>
        }
    </ul>
}
else if (Model.HasSearched)
{
    <div class="alert alert-warning mt-4">
        No compatible donor blood types found for <strong>@Model.RecipientBloodType</strong>
        @(Model.SearchMode == "Component" ? $" with component {Model.ComponentType}" : "").
    </div>
}
